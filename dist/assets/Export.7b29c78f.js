import{r as k,c as N,a as E,$ as s,b as g,d as y,e as z,f as O,g as j,h as F,j as l,i as w,T as P,F as R,E as v,k as H,l as D,A as B,m as _,n as q,o as U,p as W,q as V}from"./index.b4ce913e.js";import{$,i as G}from"./validations.f9f88ca6.js";const X=({className:e})=>({collapseWrapper:N(E({boxSizing:"border-box",overflow:"hidden",height:0,display:"none",transition:`height ${s.transitionDurationDefault} ${s.transitionEasingDefault}, padding ${s.transitionDurationDefault} ${s.transitionEasingDefault}`}),e)}),K=({children:e,className:i,isExpanded:t=!1,testId:a="cf-collapse",...o})=>{const d=k.exports.useRef(null),u=X({className:i}),f=()=>{const{current:c}=d;return c?`${c.scrollHeight}px`:"0px"};return k.exports.useLayoutEffect(()=>{const{current:c}=d,n=()=>{c&&(t?c.style.setProperty("height","auto"):(c.style.removeProperty("pointer-events"),c.style.setProperty("display","none")))};return c&&(c.addEventListener("transitionend",n),requestAnimationFrame(function(){t?(c.style.setProperty("display","block"),c.style.removeProperty("pointer-events")):c.style.setProperty("pointer-events","none");const m=t?"0px":f(),x=t?f():"0px";c.style.setProperty("height",m),requestAnimationFrame(function(){c.style.setProperty("height",x)})})),()=>{c&&c.removeEventListener("transitionend",n)}},[t]),g.createElement(y,{...o,testId:a,role:"region","aria-hidden":!t,className:u.collapseWrapper,ref:d},e)},Y=({className:e})=>({accordion:N(E({boxSizing:"border-box",padding:"0",margin:"0",listStyle:"none","&:first-child":{borderTop:`1px solid ${s.gray300}`}}),e)}),J=({align:e="end",children:i,className:t,testId:a="cf-ui-accordion",...o},d)=>{const u=Y({className:t});return g.createElement(y,{as:"ul",className:u.accordion,testId:a,...o,ref:d},g.Children.map(i,f=>g.isValidElement(f)?g.cloneElement(f,{align:e}):f))},Q=g.forwardRef(J),Z=({align:e})=>N(E({display:"flex",flexDirection:"row",alignItems:"center",border:"0",padding:s.spacingM,backgroundColor:"transparent",fontFamily:s.fontStackPrimary,fontSize:s.fontSizeL,fontWeight:s.fontWeightDemiBold,lineHeight:s.lineHeightL,color:s.gray800,width:"100%",minWidth:"9px",cursor:"pointer",transition:`background-color ${s.transitionDurationDefault} ${s.transitionEasingDefault},
        box-shadow ${s.transitionDurationShort} ${s.transitionEasingDefault}`,"&:hover":{backgroundColor:s.gray100},"&:focus":{backgroundColor:s.gray100,borderRadius:s.borderRadiusMedium,boxShadow:s.glowPrimary,outline:"none"},"&:focus:not(:focus-visible)":{backgroundColor:"transparent",borderRadius:"unset",boxShadow:"unset"},"&:focus-visible":{backgroundColor:s.gray100,borderRadius:s.borderRadiusMedium,boxShadow:s.glowPrimary}}),e==="end"&&E({name:"1tvf3d0",styles:"flex-direction:row-reverse;justify-content:space-between;"})),T=({align:e,isExpanded:i})=>N(E({transform:"rotate(0deg)",transition:`transform ${s.transitionDurationDefault} ${s.transitionEasingDefault}`}),e==="end"&&E({marginLeft:s.spacingM}),e==="start"&&E({marginRight:s.spacingM}),i&&E({name:"4ky835",styles:"transform:rotate(180deg);"})),ee=e=>({accordionHeader:Z(e),accordionHeaderIcon:T(e)}),ae=({children:e,onClick:i,isExpanded:t=!1,ariaId:a,element:o="h2",align:d="end",testId:u="cf-ui-accordion-header",...f})=>{const c=ee({align:d,isExpanded:t});return g.createElement(j,{...f,testId:u,marginBottom:"none",as:o},g.createElement("button",{type:"button","aria-expanded":t,"aria-controls":`accordion-panel--${a}`,id:`accordion--${a}`,className:c.accordionHeader,onClick:i},g.createElement(F,{className:c.accordionHeaderIcon,variant:"secondary"}),e))},te=()=>({accordionPanelContent:E({width:"100%",padding:`${s.spacingXs} ${s.spacingM} ${s.spacingM}`})}),oe=({children:e,isExpanded:i=!1,ariaId:t,testId:a="cf-ui-accordion-panel",...o})=>{const d=te();return g.createElement(K,{"data-test-id":a,"aria-labelledby":`accordion--${t}`,isExpanded:i,...o},g.createElement("div",{className:d.accordionPanelContent},e))},ne=({className:e})=>({accordionItem:N(E({padding:"0",margin:"0",borderBottom:`1px solid ${s.colorElementMid}`,"&:first-child":{borderTop:`1px solid ${s.colorElementMid}`}}),e)}),ie=({title:e="Accordion Title",titleElement:i="h2",testId:t="cf-ui-accordion-item",onExpand:a,onCollapse:o,children:d,align:u="end",className:f,isExpanded:c,...n},m)=>{const x=ne({className:f}),C=z(),{isOpen:r,handleOpen:S,handleClose:b}=O({isOpen:c,onOpen:a,onClose:o}),p=()=>{r?b():S()};return g.createElement(y,{as:"li",className:x.accordionItem,testId:`${t}-${C}`,...n,ref:m},g.createElement(ae,{onClick:p,isExpanded:r,element:i,ariaId:C,align:u},e),g.createElement(oe,{ariaId:C,isExpanded:r},d))},se=g.forwardRef(ie),A=Q;A.Item=se;function ce(e){const[i,t]=k.exports.useState(!0);return l(w,{...e,onChange:o=>{var d;t((d=o==null?void 0:o.target)==null?void 0:d.checked)},isChecked:i,value:i?P:R})}const re=async function(e,i,t,a,o){const d=de(e,t,i,a,o);fe(d,i)};function le(e,i,t){let a={};return i==null||i.fields.forEach(o=>{var d;if(o.localized)for(let u=0;u<e.length;u++)((d=e[u])==null?void 0:d.id)===(o==null?void 0:o.id)&&(o==null?void 0:o.localized)?t.forEach(f=>{a[e[u]]={...a[e[u]],[f.code]:""}}):a[e[u]]={[v]:""}}),a}const de=function(e,i,t,a,o){var C;console.log(o);let d=[],u=t+","+i.replaceAll("fields.",""),f=u;a==null||a.fields.forEach(r=>{r.localized?u=u.replace(r.id,r.id+","+r.id):f=u.replace(r.id,v)}),f=u.concat(),a==null||a.fields.forEach(r=>{r.localized?o.forEach(S=>{f=f.replace(r.id,S.code)}):(f=f.replace(r.id,v),f=f.replace(t,v))}),d.push(u),d.push(f);const c=le(u.split(","),{...a},o);let n="";console.log(c);const m=e.map(r=>({...c,...r}));console.log(m);const x=[];return(C=a==null?void 0:a.fields)==null||C.forEach(r=>{r.localized&&x.push(r.id)}),console.log(m),m.map(r=>{Object.entries(r).forEach(b=>{let p=b[0],h=b[1];x.includes(p)?o.forEach(I=>{typeof h[I.code]=="boolean"?n+=!!h[I.code]+",":n+=(h[I.code]?h[I.code]:"")+","}):(console.log(h["en-US"]),typeof h[v]=="boolean"?n+=!!h[v]+",":n+=(h[v]?h[v]:"")+",")}),console.log(n),d.push(n),n=""}),d.join(`
`)},fe=function(e,i){const t=document.createElement("a");t.setAttribute("href","data:text/csv;charset=utf-8,%EF%BB%BF"+encodeURI(e)),t.setAttribute("target","_blank"),t.setAttribute("download",i+"-"+new Date().toString()+".csv"),t.click()},ue=e=>{var f,c;const[i,t]=k.exports.useState(!1),a=H.useCMA();async function o(n,m){if(n!==void 0)return await a.entry.getMany({query:{content_type:n,select:m,locale:"*"}})}const d=(n,m,x,C)=>{t(!0),o(n,m).then(r=>{var p;const S=(p=r==null?void 0:r.items)==null?void 0:p.filter(h=>G(h)),b=S==null?void 0:S.map(h=>{var M;const I={};I[n]={"en-US":(M=h==null?void 0:h.sys)==null?void 0:M.id};const L=h.fields;return{...I,...L}});b&&(b==null?void 0:b.length)>=1?(re(b,n,m,x,C),t(!1)):console.error("No entries available")})},u=(n,m)=>{var b;m.preventDefault();const x=(b=n==null?void 0:n.sys)==null?void 0:b.id,C=new FormData(m.target),r={};for(let p of C.entries())r[p[0]]=Boolean(p[1]);const S=Object.keys(r).toString();a.locale.getMany({}).then(p=>{d(x,S,n,p.items)})};return l(k.exports.Fragment,{children:D("form",{onSubmit:u.bind({},e==null?void 0:e.contentTypeEntry),children:[D($,{children:[l($.Head,{children:D($.Row,{children:[l($.Cell,{children:"#"}),l($.Cell,{children:"Name"}),l($.Cell,{children:"ID"}),l($.Cell,{children:"Type"}),l($.Cell,{children:"Required"}),l($.Cell,{children:"Localized"})]})}),l($.Body,{children:(c=(f=e==null?void 0:e.contentTypeEntry)==null?void 0:f.fields)==null?void 0:c.map((n,m)=>D($.Row,{children:[l($.Cell,{children:B.includes(n.type)?l(ce,{helpText:n.localized,name:"fields."+n.id}):l(w,{name:n.id,isDisabled:!0})}),l($.Cell,{children:n.name}),l($.Cell,{children:n.id}),l($.Cell,{children:n.type}),l($.Cell,{children:n.required?P:R}),l($.Cell,{children:n.localized?P:R})]},m.toString()+Math.random()))})]}),l(_,{style:{margin:"10px",float:"right"},type:"submit",variant:"positive",value:i?"Exporting":"Export",children:"Export"})]})})},me=ue,$e=()=>l(y,{marginTop:"spacingM",children:l(q,{children:Array(3).fill("").map((e,i)=>l(U,{title:"loading",className:"entity-loading",isLoading:!0},i))})}),he=$e;function pe(){const[e,i]=k.exports.useState([]),t=H.useCMA();return k.exports.useEffect(()=>{console.log("useEffect main Effect");function a(){t.contentType.getMany({}).then(o=>{i(o.items)}).catch(()=>[])}a()},[]),D(y,{marginTop:"spacingXl",children:[l(W,{children:"Please select Content Type to export "}),D(A,{children:[(e==null?void 0:e.length)===0&&l(he,{}),(e==null?void 0:e.length)!==0&&e.map((a,o)=>l(A.Item,{title:a.name,children:l(V,{children:l(me,{contentTypeEntry:a})})},o+Math.random()))]})]})}export{pe as default};
